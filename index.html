<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>外太空导航</title>
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0MCIgZmlsbD0iIzAwMDBmZiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggZD0iTTUwIDUwTDYwIDYwTTUwIDUwTDQwIDYwTTUwIDUwTDYwIDQwTTUwIDUwTDQwIDQwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiLz48L3N2Zz4=">
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJzdGFycyIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxIiBmaWxsPSJ3aGl0ZSIvPjxjaXJjbGUgY3g9IjQwIiBjeT0iNDAiIHI9IjEiIGZpbGw9IndoaXRlIi8+PGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMC41IiBmaWxsPSJ3aGl0ZSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzAwMDAzMyIvPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjc3RhcnMpIiBvcGFjaXR5PSIwLjUiLz48L3N2Zz4=') no-repeat center center fixed; background-size: cover; color: #fff; transition: background 0.5s; }
        body.light { background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJzdGFycyIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxIiBmaWxsPSIjZmZmZjAwIi8+PGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iMSIgzmlsbD0iI2ZmZmYwMCIvPjxjaXJjbGUgY3g9IjIwIiBjeT0iMjAiIHI9IjAuNSIgZmlsbD0iI2ZmZmYwMCIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzAwMDBmZiIvPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjc3RhcnMpIiBvcGFjaXR5PSIwLjUiLz48L3N2Zz4=') no-repeat center center fixed; background-size: cover; color: #000; }
        .nav-bar { position: fixed; top: 0; left: 0; right: 0; display: flex; justify-content: space-between; padding: 10px; background: rgba(0,0,0,0.5); transition: opacity 0.3s; z-index: 1000; }
        .nav-bar.hidden { opacity: 0; pointer-events: none; }
        .widget-container { display: flex; justify-content: space-around; padding: 20px; }
        .widget { background: rgba(255,255,255,0.1); border-radius: 10px; padding: 10px; text-align: center; width: 30%; animation: glow 2s infinite; }
        @keyframes glow { 0% { box-shadow: 0 0 5px #fff; } 50% { box-shadow: 0 0 20px #fff; } 100% { box-shadow: 0 0 5px #fff; } }
        .search-bar { margin: 20px auto; width: 50%; }
        #searchInput { width: 100%; padding: 10px; border-radius: 20px; border: none; background: rgba(255,255,255,0.2); color: inherit; }
        .bookmark-container { display: flex; flex-wrap: wrap; justify-content: center; }
        .bookmark { background: rgba(255,255,255,0.1); border-radius: 10px; margin: 10px; padding: 10px; width: 150px; text-align: center; cursor: pointer; transition: transform 0.3s; }
        .bookmark:hover { transform: scale(1.1); }
        .bookmark img { width: 32px; height: 32px; }
        .folder { background: rgba(0,0,255,0.2); }
        .folder-content { display: none; }
        .folder.open .folder-content { display: block; }
        .ad-container { display: flex; justify-content: space-around; padding: 20px; }
        .ad { width: 30%; height: 100px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .ad img { width: 100%; height: 100%; object-fit: cover; }
        .footer { text-align: center; padding: 10px; background: rgba(0,0,0,0.5); }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: #fff; color: #000; padding: 20px; border-radius: 10px; width: 80%; max-width: 600px; }
        .loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); padding: 20px; border-radius: 10px; display: none; z-index: 2000; }
        @media (max-width: 768px) { .widget-container { flex-direction: column; } .widget { width: 100%; margin-bottom: 10px; } .ad-container { flex-direction: column; } .ad { width: 100%; margin-bottom: 10px; } }
    </style>
</head>
<body class="dark">
    <div class="nav-bar">
        <button id="modeToggle">切换模式</button>
        <button id="settingsBtn">设置</button>
        <button id="editBtn" disabled>进入编辑中心</button>
    </div>
    <div class="widget-container">
        <div class="widget" id="onlineTime">在线时长: 0s</div>
        <div class="widget" id="healthReminder">健康提醒</div>
        <div class="widget" id="worldClock"></div>
    </div>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="搜索书签...">
    </div>
    <div class="bookmark-container" id="bookmarks"></div>
    <div class="ad-container">
        <div class="ad" id="ad1"></div>
        <div class="ad" id="ad2"></div>
        <div class="ad" id="ad3"></div>
    </div>
    <div class="footer" id="footer"></div>
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <h2>设置</h2>
            <form id="githubForm">
                <label>GitHub 用户名:</label><input type="text" id="githubUsername"><br>
                <label>仓库名:</label><input type="text" id="githubRepo"><br>
                <label>GitHub Token:</label><input type="text" id="githubToken"><br>
                <button type="button" id="validateBtn">验证</button>
                <p id="validationStatus"></p>
            </form>
            <button id="closeSettings">关闭</button>
        </div>
    </div>
    <div class="modal" id="editModal">
        <div class="modal-content">
            <h2>编辑中心</h2>
            <section>
                <h3>书签管理</h3>
                <button id="addBookmarkBtn">添加书签</button>
                <input type="file" id="importFile" accept=".html">
                <button id="importBtn">导入书签</button>
                <button id="exportBtn">导出书签</button>
                <p id="bookmarkCount">书签数量: 0</p>
                <div id="bookmarkList"></div>
            </section>
            <section>
                <h3>城市管理</h3>
                <input type="text" id="newCity" placeholder="添加城市">
                <button id="addCityBtn">添加</button>
                <div id="cityList"></div>
            </section>
            <section>
                <h3>广告管理</h3>
                <div id="adEdit">
                    <div>广告1: <input type="file" id="adImg1" accept="image/*"><input type="text" id="adLink1" placeholder="链接"><button class="saveAd" data-index="0">保存</button><button class="deleteAd" data-index="0">删除</button></div>
                    <div>广告2: <input type="file" id="adImg2" accept="image/*"><input type="text" id="adLink2" placeholder="链接"><button class="saveAd" data-index="1">保存</button><button class="deleteAd" data-index="1">删除</button></div>
                    <div>广告3: <input type="file" id="adImg3" accept="image/*"><input type="text" id="adLink3" placeholder="链接"><button class="saveAd" data-index="2">保存</button><button class="deleteAd" data-index="2">删除</button></div>
                </div>
            </section>
            <button id="saveChanges">保存更改</button>
            <button id="closeEdit">关闭</button>
        </div>
    </div>
    <div class="loading" id="loading">加载中...</div>
    <script>
        let appData = { bookmarks: [], cities: ["北京", "纽约", "伦敦", "东京"], ads: [{}, {}, {}], github: { username: '<!-- REPO_OWNER -->', repo: '<!-- REPO_NAME -->', token: localStorage.getItem('githubToken') || '', validated: false } };
        let onlineStart = Date.now();
        let scrollTimeout;
        async function init() {
            document.body.classList.add(localStorage.getItem('mode') || 'dark');
            if (appData.github.username !== '<!-- REPO_OWNER -->') document.getElementById('githubUsername').value = appData.github.username;
            if (appData.github.repo !== '<!-- REPO_NAME -->') document.getElementById('githubRepo').value = appData.github.repo;
            if (appData.github.token) { document.getElementById('githubToken').value = appData.github.token; validateGitHubToken(); }
            await loadDataFromGitHub();
            renderBookmarks(appData.bookmarks);
            renderAds();
            renderFooter();
            updateOnlineTime();
            updateHealthReminder();
            updateWorldClock();
            updateEditFeaturesStatus();
            setInterval(updateOnlineTime, 1000);
            setInterval(updateHealthReminder, 60000);
            setInterval(updateWorldClock, 1000);
        }
        async function loadDataFromGitHub() {
            showLoading(true);
            try {
                let url;
                if (appData.github.token) {
                    url = `https://api.github.com/repos/${appData.github.username}/${appData.github.repo}/contents/bookmarks.json`;
                    const res = await fetch(url, { headers: { Authorization: `token ${appData.github.token}` } });
                    if (res.ok) {
                        const data = await res.json();
                        const content = JSON.parse(atob(data.content));
                        appData.bookmarks = content.bookmarks || [];
                        appData.cities = content.cities || ["北京", "纽约", "伦敦", "东京"];
                        appData.ads = content.ads || [{}, {}, {}];
                    }
                } else {
                    url = `https://raw.githubusercontent.com/${appData.github.username}/${appData.github.repo}/main/bookmarks.json`;
                    const res = await fetch(url);
                    if (res.ok) {
                        const content = await res.json();
                        appData.bookmarks = content.bookmarks || [];
                        appData.cities = content.cities || ["北京", "纽约", "伦敦", "东京"];
                        appData.ads = content.ads || [{}, {}, {}];
                    }
                }
            } catch (e) { console.error('加载失败', e); }
            showLoading(false);
        }
        async function saveDataToGitHub() {
            showLoading(true);
            if (!appData.github.validated) { alert('请先验证GitHub信息'); showLoading(false); return; }
            try {
                const content = JSON.stringify({ bookmarks: appData.bookmarks, cities: appData.cities, ads: appData.ads });
                const base64Content = btoa(unescape(encodeURIComponent(content)));
                const url = `https://api.github.com/repos/${appData.github.username}/${appData.github.repo}/contents/bookmarks.json`;
                const res = await fetch(url, { method: 'GET', headers: { Authorization: `token ${appData.github.token}` } });
                let sha;
                if (res.ok) { const data = await res.json(); sha = data.sha; }
                const putRes = await fetch(url, { method: 'PUT', headers: { Authorization: `token ${appData.github.token}`, 'Content-Type': 'application/json' }, body: JSON.stringify({ message: 'Update bookmarks', content: base64Content, sha }) });
                if (putRes.ok) { alert('保存成功'); await loadDataFromGitHub(); renderBookmarks(appData.bookmarks); renderAds(); renderFooter(); updateWorldClock(); } else { alert('保存失败'); }
            } catch (e) { console.error('保存失败', e); alert('保存失败: ' + e.message); }
            showLoading(false);
        }
        async function validateGitHubToken() {
            showLoading(true);
            const username = document.getElementById('githubUsername').value || appData.github.username;
            const repo = document.getElementById('githubRepo').value || appData.github.repo;
            const token = document.getElementById('githubToken').value;
            try {
                const res = await fetch(`https://api.github.com/repos/${username}/${repo}`, { headers: { Authorization: `token ${token}` } });
                if (res.ok) {
                    appData.github.username = username;
                    appData.github.repo = repo;
                    appData.github.token = token;
                    appData.github.validated = true;
                    localStorage.setItem('githubToken', token);
                    document.getElementById('validationStatus').textContent = '验证成功';
                    updateEditFeaturesStatus();
                } else {
                    appData.github.validated = false;
                    document.getElementById('validationStatus').textContent = '验证失败';
                }
            } catch (e) { document.getElementById('validationStatus').textContent = '验证错误: ' + e.message; }
            showLoading(false);
        }
        function updateEditFeaturesStatus() {
            document.getElementById('editBtn').disabled = !appData.github.validated;
            const editElements = document.querySelectorAll('#editModal button:not(#closeEdit), #editModal input');
            editElements.forEach(el => el.disabled = !appData.github.validated);
        }
        function renderBookmarks(bookmarks, container = document.getElementById('bookmarks'), isEdit = false) {
            container.innerHTML = '';
            bookmarks.forEach((bm, index) => {
                if (bm.folder) {
                    const folderDiv = document.createElement('div');
                    folderDiv.className = 'bookmark folder';
                    folderDiv.innerHTML = `<div>${bm.name}</div><div class="folder-content"></div>`;
                    folderDiv.addEventListener('click', () => folderDiv.classList.toggle('open'));
                    renderBookmarks(bm.children, folderDiv.querySelector('.folder-content'), isEdit);
                    if (isEdit) {
                        const editBtn = document.createElement('button');
                        editBtn.textContent = '编辑';
                        editBtn.onclick = () => editBookmark(bookmarks, index);
                        const delBtn = document.createElement('button');
                        delBtn.textContent = '删除';
                        delBtn.onclick = () => { if (confirm('确认删除?')) { bookmarks.splice(index, 1); renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true); } };
                        folderDiv.append(editBtn, delBtn);
                    }
                    container.appendChild(folderDiv);
                } else {
                    const bmDiv = document.createElement('div');
                    bmDiv.className = 'bookmark';
                    let favicon = bm.favicon || `data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${bm.name[0]}</text></svg>`;
                    bmDiv.innerHTML = `<img src="${favicon}" alt="${bm.name}"><div>${bm.name}</div>`;
                    bmDiv.addEventListener('click', () => window.open(bm.url, '_blank'));
                    if (isEdit) {
                        const editBtn = document.createElement('button');
                        editBtn.textContent = '编辑';
                        editBtn.onclick = () => editBookmark(bookmarks, index);
                        const delBtn = document.createElement('button');
                        delBtn.textContent = '删除';
                        delBtn.onclick = () => { if (confirm('确认删除?')) { bookmarks.splice(index, 1); renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true); } };
                        bmDiv.append(editBtn, delBtn);
                    }
                    container.appendChild(bmDiv);
                }
            });
            if (!isEdit) filterBookmarks();
            else document.getElementById('bookmarkCount').textContent = `书签数量: ${countBookmarks(appData.bookmarks)}`;
        }
        function countBookmarks(bms) {
            return bms.reduce((acc, bm) => acc + (bm.folder ? countBookmarks(bm.children) : 1), 0);
        }
        function editBookmark(parent, index) {
            const bm = parent[index];
            const name = prompt('编辑名称', bm.name);
            const url = prompt('编辑URL', bm.url);
            if (name && url) {
                bm.name = name;
                bm.url = url;
                fetchFavicon(url).then(fav => { bm.favicon = fav; renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true); });
            }
        }
        async function fetchFavicon(url) {
            try {
                const domain = new URL(url).origin;
                const res = await fetch(`https://www.google.com/s2/favicons?domain=${domain}`);
                return res.ok ? res.url : '';
            } catch { return ''; }
        }
        function filterBookmarks() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const bms = document.querySelectorAll('.bookmark');
            bms.forEach(bm => {
                const text = bm.textContent.toLowerCase();
                bm.style.display = text.includes(query) ? '' : 'none';
            });
        }
        function renderAds() {
            appData.ads.forEach((ad, i) => {
                const adEl = document.getElementById(`ad${i+1}`);
                adEl.innerHTML = '';
                if (ad.img && ad.link) {
                    const img = document.createElement('img');
                    img.src = ad.img;
                    adEl.appendChild(img);
                    adEl.addEventListener('click', () => window.open(ad.link, '_blank'));
                }
            });
        }
        function renderFooter() {
            const total = countBookmarks(appData.bookmarks);
            const year = new Date().getFullYear();
            const hostname = location.hostname;
            document.getElementById('footer').innerHTML = `<div class="dark-white"><div>共收录${total}个网站</div><div>Copyright © 2018-${year} ${hostname}, All Rights Reserved</div></div>`;
        }
        function updateOnlineTime() {
            const time = Math.floor((Date.now() - onlineStart) / 1000);
            document.getElementById('onlineTime').textContent = `在线时长: ${time}s`;
        }
        function updateHealthReminder() {
            const hours = Math.floor((Date.now() - onlineStart) / 3600000);
            if (hours > 0 && hours % 1 === 0) alert('健康提醒: 休息一下吧！');
        }
        function updateWorldClock() {
            const clockDiv = document.getElementById('worldClock');
            clockDiv.innerHTML = appData.cities.map(city => `<div>${city}: ${new Date().toLocaleTimeString('zh-CN', { timeZone: getTimeZone(city) })}</div>`).join('');
        }
        function getTimeZone(city) {
            const zones = { '北京': 'Asia/Shanghai', '纽约': 'America/New_York', '伦敦': 'Europe/London', '东京': 'Asia/Tokyo' };
            return zones[city] || 'UTC';
        }
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }
        document.getElementById('modeToggle').addEventListener('click', () => {
            document.body.classList.toggle('light');
            document.body.classList.toggle('dark');
            localStorage.setItem('mode', document.body.classList.contains('light') ? 'light' : 'dark');
        });
        document.getElementById('settingsBtn').addEventListener('click', () => document.getElementById('settingsModal').style.display = 'flex');
        document.getElementById('closeSettings').addEventListener('click', () => document.getElementById('settingsModal').style.display = 'none');
        document.getElementById('validateBtn').addEventListener('click', validateGitHubToken);
        document.getElementById('editBtn').addEventListener('click', () => {
            document.getElementById('editModal').style.display = 'flex';
            renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true);
            renderCityList();
        });
        document.getElementById('closeEdit').addEventListener('click', () => document.getElementById('editModal').style.display = 'none');
        document.getElementById('addBookmarkBtn').addEventListener('click', async () => {
            const name = prompt('书签名称');
            const url = prompt('URL');
            if (name && url) {
                const favicon = await fetchFavicon(url);
                appData.bookmarks.push({ name, url, favicon });
                renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true);
            }
        });
        document.getElementById('importBtn').addEventListener('click', () => document.getElementById('importFile').click());
        document.getElementById('importFile').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    try {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(ev.target.result, 'text/html');
                        const root = parseBookmarkFolder(doc.querySelector('DL'));
                        mergeBookmarks(appData.bookmarks, root.children);
                        renderBookmarks(appData.bookmarks, document.getElementById('bookmarkList'), true);
                        alert('导入成功');
                    } catch { alert('导入失败'); }
                };
                reader.readAsText(file);
            }
        });
        function parseBookmarkFolder(dl) {
            const folder = { children: [] };
            let current = dl.firstElementChild;
            while (current) {
                if (current.tagName === 'DT') {
                    if (current.firstElementChild.tagName === 'H3') {
                        const subFolder = { folder: true, name: current.firstElementChild.textContent, children: [] };
                        if (current.nextElementSibling && current.nextElementSibling.tagName === 'DL') {
                            subFolder.children = parseBookmarkFolder(current.nextElementSibling).children;
                            current = current.nextElementSibling;
                        }
                        folder.children.push(subFolder);
                    } else if (current.firstElementChild.tagName === 'A') {
                        const a = current.firstElementChild;
                        folder.children.push({ name: a.textContent, url: a.href });
                    }
                }
                current = current.nextElementSibling;
            }
            return folder;
        }
        function mergeBookmarks(existing, newBms) {
            newBms.forEach(newBm => {
                if (!existing.some(ex => ex.name === newBm.name && ex.url === newBm.url)) {
                    existing.push(newBm);
                }
            });
        }
        document.getElementById('exportBtn').addEventListener('click', () => {
            const html = generateBookmarkHTML(appData.bookmarks);
            const blob = new Blob([html], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'bookmarks.html';
            a.click();
        });
        function generateBookmarkHTML(bms, level = 0) {
            let html = level === 0 ? '<!DOCTYPE NETSCAPE-Bookmark-file-1><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><TITLE>Bookmarks</TITLE><H1>Bookmarks</H1><DL><p>' : '';
            bms.forEach(bm => {
                if (bm.folder) {
                    html += `<DT><H3>${bm.name}</H3></DT><DL><p>${generateBookmarkHTML(bm.children, level + 1)}</DL><p>`;
                } else {
                    html += `<DT><A HREF="${bm.url}">${bm.name}</A></DT>`;
                }
            });
            html += level === 0 ? '</DL><p>' : '';
            return html;
        }
        document.getElementById('addCityBtn').addEventListener('click', () => {
            const city = document.getElementById('newCity').value;
            if (city && appData.cities.length < 4) {
                appData.cities.push(city);
                renderCityList();
            }
        });
        function renderCityList() {
            const list = document.getElementById('cityList');
            list.innerHTML = '';
            appData.cities.forEach((city, i) => {
                const div = document.createElement('div');
                div.textContent = city;
                const delBtn = document.createElement('button');
                delBtn.textContent = '删除';
                delBtn.onclick = () => { appData.cities.splice(i, 1); renderCityList(); };
                div.append(delBtn);
                list.append(div);
            });
        }
        document.querySelectorAll('.saveAd').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const index = e.target.dataset.index;
                const fileInput = document.getElementById(`adImg${+index + 1}`);
                const link = document.getElementById(`adLink${+index + 1}`).value;
                if (fileInput.files[0]) {
                    if (fileInput.files[0].size > 3 * 1024 * 1024) { alert('图片超过3M'); return; }
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        appData.ads[index] = { img: ev.target.result, link };
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                } else if (link) {
                    appData.ads[index].link = link;
                }
            });
        });
        document.querySelectorAll('.deleteAd').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const index = e.target.dataset.index;
                if (confirm('确认删除?')) appData.ads[index] = {};
            });
        });
        document.getElementById('saveChanges').addEventListener('click', saveDataToGitHub);
        document.getElementById('searchInput').addEventListener('input', filterBookmarks);
        window.addEventListener('scroll', () => {
            document.querySelector('.nav-bar').classList.remove('hidden');
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => document.querySelector('.nav-bar').classList.add('hidden'), 3000);
        });
        init();
    </script>
</body>
</html>